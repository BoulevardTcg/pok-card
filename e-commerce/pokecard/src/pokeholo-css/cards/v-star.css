/*

  V STAR

*/

/* Fallback: valeur par défaut si --foil n'est pas fournie côté JS */
.card[data-rarity="rare holo vstar"] {
  --foil: url("/img/illusion.png");
}

/* ==== V-STAR — métal transparent avec foil CDN en masque ==== */

.card[data-rarity="rare holo vstar"] .card__shine,
.card[data-rarity="rare holo vstar"] .card__glare {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

/* Couche 1: remplissage métallique "sous" le reflet spéculaire */
.card[data-rarity="rare holo vstar"] .card__shine::before {
  content: "";
  position: absolute;
  inset: 0;

  /* Remplissage métal avec effet V-Star spécifique */
  background-image:
    /* reflets larges qui suivent le curseur */
    radial-gradient(
      circle at var(--pointer-x,50%) var(--pointer-y,50%),
      hsla(220, 10%, 95%, 0.70) 0%,
      hsla(220, 10%, 75%, 0.45) 22%,
      hsla(220, 10%, 60%, 0.30) 45%,
      hsla(220, 10%, 40%, 0.15) 70%,
      transparent 100%
    ),
    /* micro-irrégularités métal V-Star */
    conic-gradient(
      from calc(var(--pointer-from-left, .5) * 360deg),
      rgba(255,255,255,.30), rgba(255,255,255,0) 20%,
      rgba(255,255,255,.25) 40%, rgba(255,255,255,0) 60%,
      rgba(255,255,255,.35) 80%, rgba(255,255,255,0) 100%
    );
  background-size: 180% 180%, 200% 200%;
  background-position:
    calc(var(--pointer-x,50%)) calc(var(--pointer-y,50%)),
    center;

  /* >>> le foil CDN sert de MASQUE (zones claires = visible) */
  -webkit-mask-image: var(--foil);
          mask-image: var(--foil);
  -webkit-mask-size: cover;
          mask-size: cover;
  -webkit-mask-repeat: no-repeat;
          mask-repeat: no-repeat;
  -webkit-mask-position: center;
          mask-position: center;
  -webkit-mask-mode: luminance;
          mask-mode: luminance;

  /* fusion pour un rendu métal V-Star (ne recolore pas l'artwork) */
  mix-blend-mode: screen;
  opacity: calc(.90 * var(--card-opacity, 1));
  filter: saturate(1.8) contrast(1.2);
  z-index: 3; /* au-dessus de l'image, sous le glare */
}

/* Couche 2: highlight spéculaire (léger), pas masqué, pour le "pop" V-Star */
.card[data-rarity="rare holo vstar"] .card__glare::after {
  content: "";
  position: absolute;
  inset: 0;
  background:
    radial-gradient(
      circle at var(--pointer-x,50%) var(--pointer-y,50%),
      rgba(255,255,255,.35) 0%,
      rgba(255,255,255,.20) 22%,
      rgba(255,255,255,.08) 45%,
      transparent 60%
    );
  mix-blend-mode: screen;
  opacity: calc(.65 * var(--card-opacity, 1));
  z-index: 4;
}

/* Option: teinte "V-Star" violette/bleue (discrète), également masquée */
.card[data-rarity="rare holo vstar"] .card__shine::after {
  content: "";
  position: absolute;
  inset: 0;
  background:
    linear-gradient(135deg,
      hsla(280, 30%, 65%, .15),
      hsla(220, 25%, 60%, .15) 50%,
      hsla(200, 30%, 65%, .15)
    );
  -webkit-mask-image: var(--foil);
          mask-image: var(--foil);
  -webkit-mask-size: cover;
          mask-size: cover;
  -webkit-mask-repeat: no-repeat;
          mask-repeat: no-repeat;
  -webkit-mask-position: center;
          mask-position: center;
  -webkit-mask-mode: luminance;
          mask-mode: luminance;
  mix-blend-mode: color-dodge;
  opacity: calc(.55 * var(--card-opacity, 1));
  z-index: 3;
}

/* Petits réglages de luminosité par type si tu veux */
.card.metal    { --vstar-metal-bright: 1.00; }
.card.darkness { --vstar-metal-bright: 1.15; }
.card.lightning{ --vstar-metal-bright: 1.20; }

/* ==== ANCIEN CSS V-STAR (conservé pour compatibilité) ==== */

.card.masked[data-rarity="rare holo vstar"] .card__shine, 
.card.masked[data-rarity="rare holo vstar"] .card__shine::before, 
.card.masked[data-rarity="rare holo vstar"] .card__shine::after {

  -webkit-mask-image:  
    var(--mask), 
    radial-gradient(
      farthest-corner circle 
      at var(--pointer-x) var(--pointer-y),
      hsla(0, 0%, 100%, 0) 0%, 
      hsla(0, 0%, 100%, .5) 120%
    ); 

  mask-image: 
    var(--mask), 
    radial-gradient(
      farthest-corner circle 
      at var(--pointer-x) var(--pointer-y),
      hsla(0, 0%, 100%, 0) 0%, 
      hsla(0, 0%, 100%, .5) 120%
    );

}

/*

  SHINE LAYERS

*/

.card[data-rarity="rare holo vstar"] .card__shine,
.card[data-rarity="rare holo vstar"] .card__shine:after {

  --space: 5%;
  --angle: 133deg;
  --imgsize: cover;

  background-image:
    var(--foil),
    repeating-linear-gradient( 0deg, 
      var(--sunpillar-clr-1) calc(var(--space)*1), 
      var(--sunpillar-clr-2) calc(var(--space)*2), 
      var(--sunpillar-clr-3) calc(var(--space)*3), 
      var(--sunpillar-clr-4) calc(var(--space)*4), 
      var(--sunpillar-clr-5) calc(var(--space)*5), 
      var(--sunpillar-clr-6) calc(var(--space)*6), 
      var(--sunpillar-clr-1) calc(var(--space)*7)
    ),
    repeating-linear-gradient( 
      var(--angle), 
      #0e152e 0%, 
      hsl(180, 10%, 60%) 3.8%, 
      hsl(180, 29%, 66%) 4.5%, 
      hsl(180, 10%, 60%) 5.2%, 
      #0e152e 10% , 
      #0e152e 12% 
    ),
    radial-gradient(
      farthest-corner circle 
      at var(--pointer-x) var(--pointer-y),
      hsla(0, 0%, 0%, 0.1) 12%, 
      hsla(0, 0%, 0%, 0.15) 20%, 
      hsla(0, 0%, 0%, 0.25) 120%
    );

  background-blend-mode: soft-light, hue, hard-light;
  background-size: var(--imgsize), 200% 700%, 300% 100%, 200% 100%;
  background-position: center center, 0% var(--background-y), var(--background-x) var(--background-y), var(--background-x) var(--background-y);
  
  filter: brightness(calc((var(--pointer-from-center) * .75) + .25)) contrast(2) saturate(1.25);

}

.card[data-rarity="rare holo vstar"] .card__shine:after {

  content: "";

  background-size: var(--imgsize), 200% 400%, 195% 100%, 200% 100%;
  background-position: center center, 0% var(--background-y), calc( var(--background-x) * -1) calc( var(--background-y) * -1), var(--background-x) var(--background-y);

  filter: brightness(calc((var(--pointer-from-center) * .75) + .5)) contrast(1.5) saturate(1.5);
  mix-blend-mode: exclusion;

}

.card[data-rarity="rare holo vstar"] .card__shine::before {

  content: "";
  background-image: radial-gradient( farthest-corner circle at var(--pointer-x) var(--pointer-y), hsla(190, 7%, 80%, 0.75) 0%, hsla(260, 7%, 50%, 0.25) 45%, hsl(310, 7%, 50%) 120% );
  mix-blend-mode: hard-light;
  z-index: 2;
  opacity: 0.8;
  
}

/*

  GLARE LAYERS

*/


.card[data-rarity="rare holo vstar"] .card__glare {
  
  filter: brightness(.7) contrast(2);

  background-image: 
    radial-gradient( 
      farthest-corner circle at var(--pointer-x) var(--pointer-y), 
      hsl(195, 90%, 90%) 5%, 
      hsl(300, 3%, 60%) 60%, 
      hsl(350, 0%, 15%) 150% 
    );
  
  mix-blend-mode: hard-light;
  opacity: calc(var(--card-opacity)*(var(--pointer-from-center)*.75));

}

/*

  NO MASK

*/


.card:not(.masked)[data-rarity="rare holo vstar"] .card__shine,
.card:not(.masked)[data-rarity="rare holo vstar"] .card__shine:after {

  --mask: none;
  --foil: url("/img/ancient.png"); 
  --imgsize: 18% 15%;

  background-blend-mode: exclusion, hue, hard-light;
  filter: brightness(calc((var(--pointer-from-center) * .25) + .35)) contrast(1.8) saturate(1.75);

}

.card:not(.masked)[data-rarity="rare holo vstar"] .card__shine:after {

  filter: brightness(calc((var(--pointer-from-center) * .75) + .5)) contrast(1.5) saturate(1.5);

}


.card:not(.masked)[data-rarity="rare holo vstar"] .card__glare {
  
  filter: brightness(.55) contrast(2);

}