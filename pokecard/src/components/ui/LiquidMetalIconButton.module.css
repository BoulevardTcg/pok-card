/* LiquidMetalIconButton - Bouton rond avec bordure Liquid Metal */

.button {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 9999px;
  cursor: pointer;
  background: transparent;
  padding: 0;
  outline: none;
  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease;
}

.button:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

.button:focus-visible {
  box-shadow:
    0 0 0 2px var(--color-bg-primary),
    0 0 0 4px var(--color-accent-primary);
}

.button:hover:not(:disabled) {
  transform: scale(1.05);
}

.button:active:not(:disabled) {
  transform: scale(0.98);
}

/* Fond intérieur */
.innerBackground {
  position: absolute;
  inset: var(--bt, 3px); /* IMPORTANT: centre propre */
  border-radius: inherit;
  background: var(--liquid-btn-bg, #f4f4f5);
  box-shadow:
    inset 0 1px 2px rgba(255, 255, 255, 0.9),
    inset 0 -1px 1px rgba(0, 0, 0, 0.05),
    0 1px 3px rgba(0, 0, 0, 0.1);
  z-index: 1;
}

/* Dark mode inner background */
html[data-theme='dark'] .innerBackground {
  --liquid-btn-bg: rgba(30, 30, 35, 0.9);
  box-shadow:
    inset 0 1px 2px rgba(255, 255, 255, 0.1),
    inset 0 -1px 1px rgba(0, 0, 0, 0.3),
    0 1px 3px rgba(0, 0, 0, 0.3);
}

/* Ring container (mask appliqué ICI) */
.shaderRing {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  z-index: 2;
  overflow: hidden;
  padding: var(--bt, 3px);

  /* RING ONLY : on exclut le centre */
  -webkit-mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;

  mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  mask-composite: exclude;
}

/* Le shader doit overscan pour éviter "zones mortes" */
.shaderCanvas {
  position: absolute;
  inset: -70%;
  width: 240%;
  height: 240%;
  border-radius: inherit;
  pointer-events: none;

  /* Rendu plus "metal" */
  filter: contrast(1.25) saturate(1.1);
}

/* Specular highlights (fait vraiment premium) */
.shaderRing::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  pointer-events: none;
  opacity: 0.65;
  background:
    radial-gradient(closest-side at 28% 22%, rgba(255, 255, 255, 0.95), transparent 58%),
    radial-gradient(closest-side at 72% 78%, rgba(255, 255, 255, 0.35), transparent 62%);
  mix-blend-mode: soft-light;
}

/* Fallback ring statique */
.fallbackRing {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  z-index: 2;
  padding: var(--bt, 3px);

  background: conic-gradient(
    from 210deg,
    rgba(255, 255, 255, 0.7),
    rgba(200, 205, 215, 0.55),
    rgba(255, 255, 255, 0.78),
    rgba(175, 180, 190, 0.5),
    rgba(255, 255, 255, 0.7)
  );

  -webkit-mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  mask-composite: exclude;
}

html[data-theme='dark'] .fallbackRing {
  background: conic-gradient(
    from 210deg,
    rgba(120, 125, 140, 0.6),
    rgba(80, 85, 100, 0.45),
    rgba(130, 135, 150, 0.65),
    rgba(70, 75, 90, 0.4),
    rgba(120, 125, 140, 0.6)
  );
}

/* Icône */
.iconWrapper {
  position: relative;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-primary);
  transition: color 0.2s ease;
}

/* Animation subtile au hover */
.button:hover:not(:disabled) .shaderCanvas {
  filter: contrast(1.35) saturate(1.15);
}

/* Active state */
.button.active .innerBackground {
  background: var(--color-accent-primary);
}

.button.active .iconWrapper {
  color: var(--color-text-inverse, #ffffff);
}
